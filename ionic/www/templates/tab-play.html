<ion-view title="{{ temporary_title || title }}">

  <ion-content class="has-header padding">

    <div ng-show="showLoading()" class="loading">
        <p>Loading question...</p>
    </div>

    <div ng-show="question" class="question">
        <div class="picture">
            <img ng-src="{{ question.picture.url }}"></img>
        </div>

        <div class="list">

          <div class="item item-button-right item-outline"
               ng-class="{'item-assertive': isIncorrect(alternative), 'item-balanced': isCorrect(alternative)}"
               ng-repeat="alternative in question.choices track by alternative.id"
               ng-click="submitAnswer(alternative)">
            {{ alternative.word }}
          </div>

        </div>

    </div>

    <div class="finished" ng-show="finished">
        <p>You have finished your daily exercise. Well done!</p>
        <p>Here, have a cookie:</p>
        <div class="list">
          <a class="item" ng-repeat="question in questions" ng-click="openWordModal(question.correct.id)">
            <b>{{ question.correct.word }}</b> {{ 100 * question._correct_rate | number:0 }}%
          </a>
        </div>

    </div>

    <!-- preloading -->
    <img ng-repeat="picture in pictures"
         ng-src="{{ picture.url }}" style="display:none">
    <audio ng-repeat="word in words"
           ng-src="{{ word.mp3file }}"
           id="audio-{{ word.id }}"></audio>
    <!-- end preloading -->

  </ion-content>
</ion-view>

<script id="modal.html" type="text/ng-template">
    <div class="modal">
        <ion-header-bar class="bar-header"
         ng-class="{'bar-balanced': was_correct, 'bar-assertive': !was_correct}">
            <h1 class="title" ng-show="was_correct">Correct!</h1>
            <h1 class="title" ng-show="!was_correct">Incorrect</h1>
        </ion-header-bar>
        <ion-content>
          <div class="picture">
              <img ng-src="{{ question.picture.url }}"></img>
          </div>
            <p ng-show="!was_correct">
              The right answer was <strong>{{ question.correct.word }}</strong>.<br>
              <span ng-show="!question.correct.explanation">
                You clicked on <strong>{{ clicked.word }}</strong>.
              </span>
            </p>
            <p ng-show="question.correct.explanation">
              <strong>{{ clicked.word }}</strong> means <strong>{{ question.correct.explanation }}</strong>
            </p>
            <button class="button button-block button-positive icon-right ion-chevron-right"
              ng-click="closeModalAndNextQuestion()">
            Next question in <b>{{ modal_close_time_left }}</b>
            </button>
        </ion-content>
    </div>
</script>

<script id="word-modal.html" type="text/ng-template">
    <div class="modal">
        <ion-header-bar class="bar-header">
            <h1 class="title">{{ word.word }}</h1>
        </ion-header-bar>
        <ion-content>

            <p>
            You get this word right <strong>{{ 100 * correct_rate | number:0 }}%</strong> of the time.
            </p>

            <button class="button icon ion-volume-medium" ng-click="playWord(word)"></button>

            <button class="button button-full button-positive"
              ng-click="closeWordModal()">
              Close
            </button>
        </ion-content>
    </div>
</script>
